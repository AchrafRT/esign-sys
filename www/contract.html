<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>9999 — Contrat</title>
  <style>
    :root{
      --bg:#0b0f19;
      --panel:rgba(17,24,39,.78);
      --line:rgba(255,255,255,.10);
      --ink:#e5e7eb;
      --muted:#94a3b8;
      --gold:#f5c542;
      --paper-shadow:0 22px 60px rgba(0,0,0,.40);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 18% 8%, rgba(245,197,66,.10), transparent 60%),
        radial-gradient(900px 600px at 85% 18%, rgba(59,130,246,.10), transparent 55%),
        var(--bg);
    }
    .topbar{
      position:sticky; top:0; z-index:50;
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
      padding:12px 14px;
      background:var(--panel);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--line);
    }
    .brand{font-weight:900; letter-spacing:.4px}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(15,23,42,.75);
      font-size:12px; font-weight:900;
    }
    .pill b{color:var(--gold)}
    .btn{
      appearance:none; border:1px solid var(--line);
      border-radius:12px;
      padding:9px 12px;
      cursor:pointer;
      text-decoration:none;
      font-weight:900;
      background:var(--gold);
      color:#111;
    }
    .btn.secondary{background:rgba(15,23,42,.80); color:var(--ink)}
    .hint{font-size:12px; color:var(--muted); font-weight:700}
    .viewer{
      max-width: 1100px;
      margin: 18px auto 90px;
      padding: 0 14px;
    }
    .viewerCard{
      padding: 14px;
      border-radius: var(--radius);
      border:1px solid var(--line);
      background: rgba(15,23,42,.55);
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
    }

    /* The deterministic trick:
       - page container fits the image exactly (no padding, no border)
       - fields are positioned as % of image area (computed from pixel map)
    */
    .page{
      position:relative;
      margin: 18px auto;
      background:#fff;
      border-radius: 18px;
      overflow:hidden;
      box-shadow: var(--paper-shadow);
      width: var(--page-render-w, 980px);
      max-width: 100%;
    }
    .page img.bg{
      width:100%;
      height:auto;
      display:block;
      user-select:none;
      -webkit-user-drag:none;
    }
    .overlay{
      position:absolute;
      left:0; top:0; right:0; bottom:0;
    }
    .field{
      position:absolute;
      display:flex;
      align-items:flex-end; /* baseline-ish */
    }
    .field input{
      width:100%;
      height:100%;
      border:0;
      border-bottom: 1px solid rgba(0,0,0,.55);
      border-radius:0;
      background:transparent;
      padding:0 2px;
      margin:0;
      font-size: 15px;
      line-height: 1;
      outline:none;
      color:#000;
    }
    .field input:focus{
      border-bottom: 2px solid rgba(0,0,0,.90);
      background:rgba(0,0,0,.02);
    }

    .field input[type="checkbox"]{
      width: 18px;
      height: 18px;
      border: 1px solid rgba(0,0,0,.55);
      border-radius: 4px;
      margin: 0;
      padding: 0;
      appearance: none;
      background: rgba(255,255,255,.0);
    }
    .field input[type="checkbox"]:checked{
      background: rgba(0,0,0,.85);
      box-shadow: inset 0 0 0 3px #fff;
    }

    .field input[readonly]{
      border-bottom: 1px solid rgba(0,0,0,.25);
      color:#111;
      opacity:.85;
    }

    .sigzone{
      position:absolute;
      border: 2px dashed rgba(0,0,0,.35);
      border-radius: 14px;
      overflow:hidden;
      background: rgba(255,255,255,.35);
    }
    .sigzone .lock{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      flex-direction:column; gap:10px;
      background: rgba(255,255,255,.78);
      color:#0b0f19;
      font-weight:1000;
      text-align:center;
      padding:10px;
    }
    .sigzone .lock .small{font-size:12px;font-weight:800;opacity:.78}
    .sigzone img{width:100%;height:100%;object-fit:contain;background:rgba(255,255,255,.60)}

    @media print{
      body{background:#fff}
      .topbar,.viewerCard{display:none}
      .viewer{max-width:none;margin:0;padding:0}
      .page{box-shadow:none;border-radius:0;margin:0;page-break-after:always}
      .field input{border:none;background:transparent}
      .sigzone{border:none}
    }
  
.computedbox{width:100%;height:100%;display:flex;align-items:center;justify-content:flex-end;padding:0 10px;border-radius:12px;border:1px solid rgba(255,255,255,.10);background:rgba(15,23,42,.80);color:#e5e7eb;font-weight:900;font-variant-numeric:tabular-nums;}
</style>
</head>
<body>
  <form id="saveform" method="POST" action="/contract/save">
    <!--TOPBAR-->
    <!--PAGES-->
  </form>
<script>
// Deterministic mode: no live compute. Use “Sauvegarder & Calculer”.
</script>
</body>
</html>